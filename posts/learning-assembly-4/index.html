<!DOCTYPE html>
<html lang="en-us">
  <head>
    <title>汇编语言学习笔记（四）：寄存器[内存访问] | Yizhou&#39;s Website</title>

    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">    
<meta name="viewport" content="width=device-width,minimum-scale=1">
<meta name="description" content="内存中字的储存 🔗在8086CPU中，寄存器为16位，可以储存一个字(1Word=2Byte)，拿ax来说，低8位放在al中，高8位放在ah中">
<meta name="generator" content="Hugo 0.121.1">


  <META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">


<link rel="stylesheet" href="/css/style.css">



<link rel="shortcut icon" href="/images/favicon.ico" type="image/x-icon" />




  





    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
          "HTML-CSS": { scale: 85 },
          tex2jax: {
            inlineMath: [['$','$'], ['\\(','\\)']],
            processEscapes: true
          }
        });
    </script>
    
    <script src='https://cdn.jsdelivr.net/npm/mathjax@2.7.4/MathJax.js?config=TeX-AMS-MML_HTMLorMML' async></script>





  </head>

  <body>
    <nav class="navigation">
	
		<a href="/"> <span class="arrow">←</span>首页</a>
	
	<a href="/posts">归档</a>
	<a href="/tags">标签</a>
	<a href="/about">关于</a>

	

	
	  <a class="button" href="https://wuyizhou.com/index.xml">订阅</a>
	
</nav>


    <main class="main">
      

<section id="single">
    <h1 class="title">汇编语言学习笔记（四）：寄存器[内存访问]</h1>

    <div class="tip">
        <time datetime="2018-02-23 16:45:57 &#43;0000 UTC">2018年02月23日</time>
        <span class="split">
          ·
        </span>
        <span>
          1985字
        </span>
        <span class="split">
          ·
        </span>
        <span>
          4分钟
        </span>
    </div>

    
    
        
  
    <aside class="toc">
      <details>
          <summary>Table of Contents
          </summary>
          <div>
              <nav id="TableOfContents">
  <ul>
    <li><a href="#内存中字的储存">内存中字的储存</a></li>
    <li><a href="#数据的读写">数据的读写</a></li>
    <li><a href="#字型数据传送">字型数据传送</a></li>
    <li><a href="#cpu提供的栈以及机制">CPU提供的栈以及机制</a></li>
    <li><a href="#栈顶超界">栈顶超界</a></li>
  </ul>
</nav>
          </div>
      </details>
    </aside>
  


    


    <div class="content">
      <h2 id="内存中字的储存">内存中字的储存 <a href="#%e5%86%85%e5%ad%98%e4%b8%ad%e5%ad%97%e7%9a%84%e5%82%a8%e5%ad%98" class="anchor">🔗</a></h2><p>在8086CPU中，寄存器为16位，可以储存一个字(1Word=2Byte)，拿ax来说，低8位放在al中，高8位放在ah中。</p>
<p>在内存单元一个内存单元只能存储一个字节，那么如果存储一个字型数据就会用到两个内存单元，低8位放在低地址当中，高8位放在高地址当中，比如下图中，储存了两个字型数据，一个是4E20H，一个是0012H，它们的存放数据大概如下：</p>
<p><p class="markdown-image">
  <img src="/post/images/2018/02/1-2.png" alt="存放数据"  />
</p></p>
<p>而当连续两个内存单元储存的是一个字型数据的时候，可以将这字型数据的起始地址称为N地址字单元，比如00001内存单元和00002内存单元，可以直接称为00001地址字单元。</p>
<h2 id="数据的读写">数据的读写 <a href="#%e6%95%b0%e6%8d%ae%e7%9a%84%e8%af%bb%e5%86%99" class="anchor">🔗</a></h2><p>在第二章中写到如何操作CPU的执行指令，让内存中的数据当作指令还是数据都取决于程序员，当CS和IP指向的地址则当作指令执行，那读取数据也需要由段地址和偏移地址组成。</p>
<p>8086CPU中，数据地址的段地址由段寄存器DS来指定，<strong>并且不能直接将数据送入DS段寄存器，只能通过其他寄存器来传送给段寄存器DS（这是8086CPU的硬件设计，只需要知道就可以了）</strong>，那偏移地址呢？</p>
<p>先来看看下面的代码，下面的代码是通过ax寄存器把内存单元2000H段地址传送给DS，然后读取内存单元2000段中的0001单元：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>mov bx,2000H
</span></span><span style="display:flex;"><span>mov ds,bx
</span></span><span style="display:flex;"><span>mov al,[0001H] 
</span></span></code></pre></div><p>偏移地址是由程序员手动输入的，当编译器看见<code>[]</code>的时候，会自动把段寄存器DS中的值与<code>[]</code>号中数据进行合成为一个20位的物理地址，然后读取这个物理地址中的数据。</p>
<p>那么如何把寄存器中的数据写入内存中呢？只需要将两个位置相关换一下，就可以了，比如下面代码，把ax的低位寄存器al中的12H数据写入内存2000段中的0001单元。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>mov bx,2000H
</span></span><span style="display:flex;"><span>mov ds,bx
</span></span><span style="display:flex;"><span>mov al,12H
</span></span><span style="display:flex;"><span>mov [0001H],al 
</span></span></code></pre></div><h2 id="字型数据传送">字型数据传送 <a href="#%e5%ad%97%e5%9e%8b%e6%95%b0%e6%8d%ae%e4%bc%a0%e9%80%81" class="anchor">🔗</a></h2><p>8086CPU是16位架构，那么意味着一次性可以传输16位数据，上面操作的都是8位数据，也可以传输16位数据，只需要给出16位寄存器的名字就可以传送了，但是16位寄存器分两个内存单元储存，一个内存单元只能储存8位数据，比如储存一个8E20H数据到2000:0000内存单元中，那么20H储存在2000:0000中，而8E储存在2000:0001中。</p>
<h2 id="cpu提供的栈以及机制">CPU提供的栈以及机制 <a href="#cpu%e6%8f%90%e4%be%9b%e7%9a%84%e6%a0%88%e4%bb%a5%e5%8f%8a%e6%9c%ba%e5%88%b6" class="anchor">🔗</a></h2><p>栈是一种特殊方式访问的内存单元，那么它有什么用呢？以后会慢慢来说到，在这里只是先对栈空间有一个大概的认识，<strong>栈的特殊性在于后进先出，英文缩写为LIFO(Last in First Out)。</strong></p>
<p>这个是什么意思呢？可以把栈看作一个放书的盒子，依次放3本书进去的时候，需要取出放进去的第一本书的时候，就会先把上面的两本书依次拿出来，才能取到放进去的第一本书。</p>
<p>当需要取出哪一本书的时候，我们总会先拿出最上面的那一本书，不然无法拿到需要的书，而每取出一本书，下一本总是在最上面。</p>
<p>在程序化的角度上来说是应该有一个标记，这个标记中指向最上面的书，也就是栈顶，如下图所示：</p>
<p><p class="markdown-image">
  <img src="/post/images/2018/02/2-2.png" alt="栈"  />
</p></p>
<p>现今的CPU中都有栈的设计，包含8086，既然有栈的设计，肯定也有对栈访问的指令，其中最基本的就是PUSH（入栈）和POP（出栈），比如push ax代表将ax寄存器的数据送入栈中，入栈和出栈都是字型数据操作，比如下图是一个操作栈的例子：</p>
<p><p class="markdown-image">
  <img src="/post/images/2018/02/3-2.png" alt="栈操作"  />
</p></p>
<p>虽然说现在可以操作栈了，但是有两个疑问：</p>
<ol>
<li>栈中的数据存储在哪里？</li>
<li>上面说到，有一个标记，总是指向栈顶，那这个栈顶在哪里？</li>
</ol>
<p>上面两个问题可以归于一个，其实栈也是在内存单元中，只是它是一段特殊访问方式的空间，那既然是内存单元，那可能也有类似与段寄存器和偏移寄存器这样的寄存器来指向栈，它们就是SS:SP。</p>
<p>SS存放栈的段地址，而SP存放栈的偏移地址，SS:SP在任意时刻指向的是栈顶，我们可以通过修改SS和SP来指定哪一段内存单元为栈，那么现在就可以很好的解释push和pop指令的工作方式，比如push ax的执行，由以下两部分完成：</p>
<ol>
<li>SP=SP-2，SS:SP指向当前栈顶前面的单元，以当前栈顶起前面的单元为新栈顶。</li>
<li>将ax中的内容送入SS:SP指向的内存单元处，SS:SP此时指向新栈顶。</li>
</ol>
<p>上面的步骤可以用下图来表示：</p>
<p><p class="markdown-image">
  <img src="/post/images/2018/02/4-2.png" alt="栈顶工作"  />
</p></p>
<p>从图中可以看出，8086CPU中，入栈时，由栈顶高地址向低地址增长，而出栈就是由低地址到高地址增长。</p>
<h2 id="栈顶超界">栈顶超界 <a href="#%e6%a0%88%e9%a1%b6%e8%b6%85%e7%95%8c" class="anchor">🔗</a></h2><p>可以想象一下，当栈空间为2000H:0000H-2000H:000FH的16个内存单元时，那么当栈为空，栈顶在0010H位置，如果这时我们操作出栈，那么SP应该+2，即为0012H，那如果入栈低于了20000H这个内存空间的时候呢？这两种情况都超出了栈的范围，就会覆盖相应的内存单元的数据，比如在下面两个图中，分别对出栈和入栈都演示了一个超界的情况：</p>
<p><p class="markdown-image">
  <img src="/post/images//2018/02/5-2.png" alt="入栈超出"  />
</p></p>
<p><p class="markdown-image">
  <img src="/post/images/2018/02/6-2.png" alt="出栈超出"  />
</p></p>
<p>在内存单元中，可能存放数据，代码，也有可能存放其他应用的数据代码等，如果超出了就会出现其他未知的问题，在8086CPU中，并没有什么机制来预防这样的问题，应为8086CPU只需要关注栈顶在哪里，并不会关注栈的空间有多大，所以我们需要特别注意，这是非常危险的一个操作。</p>

    </div>

    
        <div class="tags">
            
                <a href="https://wuyizhou.com/tags/%E5%BC%80%E5%8F%91%E8%80%85%E6%89%8B%E5%86%8C">开发者手册</a>
            
        </div>
    
    
    

</section>


    </main>
    
    <footer id="footer">
    
        <div id="social">


    <a class="symbol" href="https://github.com/wyizhou" rel="me" target="_blank">
        
        <svg fill="#bbbbbb" width="28" height="28"  viewBox="0 0 72 72" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
    
    <title>Github</title>
    <desc>Created with Sketch.</desc>
    <defs></defs>
    <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
        <g id="Social-Icons---Rounded-Black" transform="translate(-264.000000, -939.000000)">
            <g id="Github" transform="translate(264.000000, 939.000000)">
                <path d="M8,72 L64,72 C68.418278,72 72,68.418278 72,64 L72,8 C72,3.581722 68.418278,-8.11624501e-16 64,0 L8,0 C3.581722,8.11624501e-16 -5.41083001e-16,3.581722 0,8 L0,64 C5.41083001e-16,68.418278 3.581722,72 8,72 Z" id="Rounded" fill="#bbbbbb"></path>
                <path d="M35.9985,13 C22.746,13 12,23.7870921 12,37.096644 C12,47.7406712 18.876,56.7718301 28.4145,59.9584121 C29.6145,60.1797862 30.0525,59.4358488 30.0525,58.7973276 C30.0525,58.2250681 30.0315,56.7100863 30.0195,54.6996482 C23.343,56.1558981 21.9345,51.4693938 21.9345,51.4693938 C20.844,48.6864054 19.2705,47.9454799 19.2705,47.9454799 C17.091,46.4500754 19.4355,46.4801943 19.4355,46.4801943 C21.843,46.6503662 23.1105,48.9634994 23.1105,48.9634994 C25.2525,52.6455377 28.728,51.5823398 30.096,50.9649018 C30.3135,49.4077535 30.9345,48.3460615 31.62,47.7436831 C26.2905,47.1352808 20.688,45.0691228 20.688,35.8361671 C20.688,33.2052792 21.6225,31.0547881 23.1585,29.3696344 C22.911,28.7597262 22.0875,26.3110578 23.3925,22.9934585 C23.3925,22.9934585 25.4085,22.3459017 29.9925,25.4632101 C31.908,24.9285993 33.96,24.6620468 36.0015,24.6515052 C38.04,24.6620468 40.0935,24.9285993 42.0105,25.4632101 C46.5915,22.3459017 48.603,22.9934585 48.603,22.9934585 C49.9125,26.3110578 49.089,28.7597262 48.8415,29.3696344 C50.3805,31.0547881 51.309,33.2052792 51.309,35.8361671 C51.309,45.0917119 45.6975,47.1292571 40.3515,47.7256117 C41.2125,48.4695491 41.9805,49.9393525 41.9805,52.1877301 C41.9805,55.4089489 41.9505,58.0067059 41.9505,58.7973276 C41.9505,59.4418726 42.3825,60.1918338 43.6005,59.9554002 C53.13,56.7627944 60,47.7376593 60,37.096644 C60,23.7870921 49.254,13 35.9985,13" fill="#FFFFFF"></path>
            </g>
        </g>
    </g>
</svg>
    </a>

    <a class="symbol" href="https://stackoverflow.com/users/11949960" rel="me" target="_blank">
        
        <svg fill="#bbbbbb" width="28" height="28" viewBox="0 0 72 72" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
    
    <title>stackoverflow</title>
    <desc>Created with Sketch.</desc>
    <defs></defs>
    <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
        <g id="Social-Icons---Rounded-Black" transform="translate(-488.000000, -1163.000000)">
            <g id="stackoverflow" transform="translate(488.000000, 1163.000000)">
                <path d="M8,72 L64,72 C68.418278,72 72,68.418278 72,64 L72,8 C72,3.581722 68.418278,-8.11624501e-16 64,0 L8,0 C3.581722,8.11624501e-16 -5.41083001e-16,3.581722 0,8 L0,64 C5.41083001e-16,68.418278 3.581722,72 8,72 Z" id="Rounded" fill="#bbbbbb"></path>
                <path d="M42.0860128,53.5922927 L22.9745951,53.6011499 L22.9729497,49.5538824 L42.0835447,49.5440929 L42.0860128,53.5922927 L42.0860128,53.5922927 Z M55,30.6708298 L51.7306912,12 L47.7087256,12.6920259 L50.9775643,31.3628557 L55,30.6708298 L55,30.6708298 Z M42.5455518,44.3547147 L23.5156994,42.616026 L23.1410164,46.6470941 L42.1712214,48.3841513 L42.5455518,44.3547147 L42.5455518,44.3547147 Z M43.8009984,39.0731519 L25.3459811,34.1539179 L24.285633,38.0621508 L42.7419431,42.9819676 L43.8009984,39.0731519 L43.8009984,39.0731519 Z M46.2103463,34.4436411 L29.7494464,24.8164635 L27.6748215,28.3015328 L44.1365441,37.9292931 L46.2103463,34.4436411 L46.2103463,34.4436411 Z M50.2466504,31.6088756 L46.8745036,33.8883189 L36.106599,18.2318456 L39.4792159,15.9517031 L50.2466504,31.6088756 Z M45.3315807,40.2784283 L48.5799693,40.2784283 L48.5799693,60 L17,60 L17,40.2784283 L20.2648427,40.2784283 L20.2648427,56.8243495 L45.3315807,56.8243495 L45.3315807,40.2784283 Z" fill="#FFFFFF"></path>
            </g>
        </g>
    </g>
</svg>
    </a>

    <a class="symbol" href="https://twitter.com/5yizhou" rel="me" target="_blank">
        
        <svg fill="#bbbbbb" width="28" height="28" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 width="438.536px" height="438.536px" viewBox="0 0 438.536 438.536" style="enable-background:new 0 0 438.536 438.536;"
	 xml:space="preserve">
<g>
	<path d="M414.41,24.123C398.333,8.042,378.963,0,356.315,0H82.228C59.58,0,40.21,8.042,24.126,24.123
		C8.045,40.207,0.003,59.576,0.003,82.225v274.084c0,22.647,8.042,42.018,24.123,58.102c16.084,16.084,35.454,24.126,58.102,24.126
		h274.084c22.648,0,42.018-8.042,58.095-24.126c16.084-16.084,24.126-35.454,24.126-58.102V82.225
		C438.532,59.576,430.49,40.204,414.41,24.123z M335.471,168.735c0.191,1.713,0.288,4.278,0.288,7.71
		c0,15.989-2.334,32.025-6.995,48.104c-4.661,16.087-11.8,31.504-21.416,46.254c-9.606,14.749-21.074,27.791-34.396,39.115
		c-13.325,11.32-29.311,20.365-47.968,27.117c-18.648,6.762-38.637,10.143-59.953,10.143c-33.116,0-63.76-8.952-91.931-26.836
		c4.568,0.568,9.329,0.855,14.275,0.855c27.6,0,52.439-8.565,74.519-25.7c-12.941-0.185-24.506-4.179-34.688-11.991
		c-10.185-7.803-17.273-17.699-21.271-29.691c4.947,0.76,8.658,1.137,11.132,1.137c4.187,0,9.042-0.76,14.56-2.279
		c-13.894-2.669-25.598-9.562-35.115-20.697c-9.519-11.136-14.277-23.84-14.277-38.114v-0.571
		c10.085,4.755,19.602,7.229,28.549,7.422c-17.321-11.613-25.981-28.265-25.981-49.963c0-10.66,2.758-20.747,8.278-30.264
		c15.035,18.464,33.311,33.213,54.816,44.252c21.507,11.038,44.54,17.227,69.092,18.558c-0.95-3.616-1.427-8.186-1.427-13.704
		c0-16.562,5.853-30.692,17.56-42.399c11.703-11.706,25.837-17.561,42.394-17.561c17.515,0,32.079,6.283,43.688,18.846
		c13.134-2.474,25.892-7.33,38.26-14.56c-4.757,14.652-13.613,25.788-26.55,33.402c12.368-1.716,23.88-4.95,34.537-9.708
		C357.458,149.793,347.462,160.166,335.471,168.735z"/>
</g>
</svg>

    </a>


</div>

    

    <div class="copyright">
    
        © Copyright 2023 Yizhou
    
    </div>

    
</footer>



  </body>
</html>

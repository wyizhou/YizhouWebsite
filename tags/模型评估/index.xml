<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>模型评估 on Lucas Wu</title>
    <link>https://0b44ccdd.vec6.com/tags/%E6%A8%A1%E5%9E%8B%E8%AF%84%E4%BC%B0/</link>
    <description>Recent content in 模型评估 on Lucas Wu</description>
    <generator>Hugo</generator>
    <language>zh-CN</language>
    <lastBuildDate>Mon, 27 Jan 2025 10:53:34 +0000</lastBuildDate>
    <atom:link href="https://0b44ccdd.vec6.com/tags/%E6%A8%A1%E5%9E%8B%E8%AF%84%E4%BC%B0/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Gird Search</title>
      <link>https://0b44ccdd.vec6.com/blog/gridsearch/</link>
      <pubDate>Mon, 27 Jan 2025 10:53:34 +0000</pubDate>
      <guid>https://0b44ccdd.vec6.com/blog/gridsearch/</guid>
      <description>&lt;p&gt;在了解网格搜索之前，需要明白参数(Parameter)和超参数(HyperParameter)的区别，Parameter是指算法通过学习数据自动计算出来得到的值，比如线性回归中的\beta系数，而HyperParameter是指人为设定、控制算法学习或者训练过程的变量，它不会被直接学习，但是会影响学习的行为和最终的学习效果。&lt;/p&gt;&#xA;&lt;p&gt;比如开车超参数就是指你可以控制踩油门的力度、驾驶模式（运动、节能或者正常），而参数则是发动机的扭矩输出、油耗和摩擦力等，是汽车本身决定的，无法直接调整的。&lt;/p&gt;&#xA;&lt;p&gt;而Grid Search的作用尝试遍历不同的超参数组合方式，生成不同的模型，并计算模型的评估值，最终找到最优超参数组合，让模型表现更好。&lt;/p&gt;&#xA;&lt;h2 id=&#34;举例&#34;&gt;举例&lt;/h2&gt;&#xA;&lt;p&gt;Sklearn提供了Grid Search搜索的函数，可以通过如下方式导入：&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;from&lt;/span&gt; sklearn.model_selection &lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; GridSearchCV&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;下面就通过演示通过Ridge回归预测房价的问题，然后通过Grid Search进行找到最佳超参数，数据为如下表格，价格为万元：&lt;/p&gt;&#xA;&lt;table&gt;&#xA;  &lt;thead&gt;&#xA;      &lt;tr&gt;&#xA;          &lt;th&gt;&lt;/th&gt;&#xA;          &lt;th&gt;area(X1)&lt;/th&gt;&#xA;          &lt;th&gt;room(X2)&lt;/th&gt;&#xA;          &lt;th&gt;price（Y）&lt;/th&gt;&#xA;      &lt;/tr&gt;&#xA;  &lt;/thead&gt;&#xA;  &lt;tbody&gt;&#xA;      &lt;tr&gt;&#xA;          &lt;td&gt;1&lt;/td&gt;&#xA;          &lt;td&gt;77&lt;/td&gt;&#xA;          &lt;td&gt;4&lt;/td&gt;&#xA;          &lt;td&gt;220&lt;/td&gt;&#xA;      &lt;/tr&gt;&#xA;      &lt;tr&gt;&#xA;          &lt;td&gt;2&lt;/td&gt;&#xA;          &lt;td&gt;89&lt;/td&gt;&#xA;          &lt;td&gt;4&lt;/td&gt;&#xA;          &lt;td&gt;230&lt;/td&gt;&#xA;      &lt;/tr&gt;&#xA;      &lt;tr&gt;&#xA;          &lt;td&gt;3&lt;/td&gt;&#xA;          &lt;td&gt;99&lt;/td&gt;&#xA;          &lt;td&gt;5&lt;/td&gt;&#xA;          &lt;td&gt;260&lt;/td&gt;&#xA;      &lt;/tr&gt;&#xA;      &lt;tr&gt;&#xA;          &lt;td&gt;4&lt;/td&gt;&#xA;          &lt;td&gt;110&lt;/td&gt;&#xA;          &lt;td&gt;6&lt;/td&gt;&#xA;          &lt;td&gt;320&lt;/td&gt;&#xA;      &lt;/tr&gt;&#xA;      &lt;tr&gt;&#xA;          &lt;td&gt;5&lt;/td&gt;&#xA;          &lt;td&gt;125&lt;/td&gt;&#xA;          &lt;td&gt;8&lt;/td&gt;&#xA;          &lt;td&gt;410&lt;/td&gt;&#xA;      &lt;/tr&gt;&#xA;  &lt;/tbody&gt;&#xA;&lt;/table&gt;&#xA;&lt;p&gt;代码为：&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; pandas &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; pd&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;from&lt;/span&gt; sklearn.model_selection &lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; GridSearchCV&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;from&lt;/span&gt; sklearn.linear_model &lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; Ridge&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;data &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; pd&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;DataFrame({&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;area&amp;#34;&lt;/span&gt;: [&lt;span style=&#34;color:#ae81ff&#34;&gt;77&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;89&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;99&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;110&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;125&lt;/span&gt;], &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;room&amp;#34;&lt;/span&gt;: [&lt;span style=&#34;color:#ae81ff&#34;&gt;4&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;4&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;6&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;8&lt;/span&gt;], &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;price&amp;#34;&lt;/span&gt;: [&lt;span style=&#34;color:#ae81ff&#34;&gt;220&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;230&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;260&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;320&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;410&lt;/span&gt;]})&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;parameters_grid &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; {&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;alpha&amp;#39;&lt;/span&gt;: [&lt;span style=&#34;color:#ae81ff&#34;&gt;0.001&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0.01&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0.1&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;]}&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;ridge_model &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Ridge()&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;grid &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; GridSearchCV(ridge_model, parameters_grid, cv&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;) &lt;span style=&#34;color:#75715e&#34;&gt;#评估指标默认使用R^2&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;grid&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;fit(data[[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;area&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;room&amp;#39;&lt;/span&gt;]], data[[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;price&amp;#39;&lt;/span&gt;]]) &lt;span style=&#34;color:#75715e&#34;&gt;# 训练模型&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;grid&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;best_estimator_ &lt;span style=&#34;color:#75715e&#34;&gt;#查看最佳的超参数，输出为alpha:100&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;grid&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;cv_results_ &lt;span style=&#34;color:#75715e&#34;&gt;#查看对应超参数以及对应的评估指标的值&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; param, mean_val &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; zip(grid&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;cv_results_[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;params&amp;#39;&lt;/span&gt;], grid&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;cv_results_[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;mean_test_score&amp;#39;&lt;/span&gt;]):&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  print(param, mean_val)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&amp;#34;&amp;#34;输出最佳的R^2值为-3.85，alpha为100&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;{&amp;#39;alpha&amp;#39;: 0.001} -5.673602295795709&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;{&amp;#39;alpha&amp;#39;: 0.01} -5.706292846025019&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;{&amp;#39;alpha&amp;#39;: 0.1} -5.9416525607274835&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;{&amp;#39;alpha&amp;#39;: 1} -6.2458204928344285&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;{&amp;#39;alpha&amp;#39;: 10} -4.4122468477234005&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;{&amp;#39;alpha&amp;#39;: 100} -3.8580109543701897&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description>
    </item>
    <item>
      <title>模型评估：MSE和R2值</title>
      <link>https://0b44ccdd.vec6.com/blog/mseandr2/</link>
      <pubDate>Sun, 19 Jan 2025 23:53:34 +0000</pubDate>
      <guid>https://0b44ccdd.vec6.com/blog/mseandr2/</guid>
      <description>&lt;p&gt;MSE和R Square是在回归分析中常用的评估指标，其中MSE评估模型的误差大小，主要用于关注预测精准度的场景，而R Square评估模型的拟合能力，用于评估模型是否能很好的解释数据，也可以将两个指标进行结合使用来评估模型。&lt;/p&gt;&#xA;&lt;p&gt;下面用一个外卖的数据来演示MSE和R Square两个指标：&lt;/p&gt;&#xA;&lt;table&gt;&#xA;  &lt;thead&gt;&#xA;      &lt;tr&gt;&#xA;          &lt;th&gt;配送距离(x)&lt;/th&gt;&#xA;          &lt;th&gt;真实配送时间(y)&lt;/th&gt;&#xA;          &lt;th&gt;预测时间(y-)&lt;/th&gt;&#xA;      &lt;/tr&gt;&#xA;  &lt;/thead&gt;&#xA;  &lt;tbody&gt;&#xA;      &lt;tr&gt;&#xA;          &lt;td&gt;1km&lt;/td&gt;&#xA;          &lt;td&gt;10min&lt;/td&gt;&#xA;          &lt;td&gt;12min&lt;/td&gt;&#xA;      &lt;/tr&gt;&#xA;      &lt;tr&gt;&#xA;          &lt;td&gt;2km&lt;/td&gt;&#xA;          &lt;td&gt;15min&lt;/td&gt;&#xA;          &lt;td&gt;14min&lt;/td&gt;&#xA;      &lt;/tr&gt;&#xA;      &lt;tr&gt;&#xA;          &lt;td&gt;3km&lt;/td&gt;&#xA;          &lt;td&gt;20min&lt;/td&gt;&#xA;          &lt;td&gt;22min&lt;/td&gt;&#xA;      &lt;/tr&gt;&#xA;      &lt;tr&gt;&#xA;          &lt;td&gt;4km&lt;/td&gt;&#xA;          &lt;td&gt;35min&lt;/td&gt;&#xA;          &lt;td&gt;30min&lt;/td&gt;&#xA;      &lt;/tr&gt;&#xA;      &lt;tr&gt;&#xA;          &lt;td&gt;5km&lt;/td&gt;&#xA;          &lt;td&gt;70min&lt;/td&gt;&#xA;          &lt;td&gt;65min&lt;/td&gt;&#xA;      &lt;/tr&gt;&#xA;  &lt;/tbody&gt;&#xA;&lt;/table&gt;&#xA;&lt;h2 id=&#34;mean-square-error&#34;&gt;Mean Square Error&lt;/h2&gt;&#xA;&lt;p&gt;Mean Square Error通过计算预测值和真实值的误差来衡量模型的预测精准度问题，其计算公式为：&#xA;$$&#xA;MSE = \frac{1}{n}(y_i - \hat y_i)^2&#xA;$$&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;$y_i$：真实预测值&lt;/li&gt;&#xA;&lt;li&gt;$\hat y_i$：模型预测值&lt;/li&gt;&#xA;&lt;li&gt;$n$：数据点的数量&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;计算过程为：&#xA;$$&#xA;MSE = \frac{1}{5} \cdot ( (10-12)^2 + (15-14)^2 + (20-22)^2 + (35-30)^2 + (70-65)^2 ) \newline&#xA;MSE = \frac{1}{5} \cdot ( 4 + 1 + 4 + 25 + 25 ) \newline&#xA;MSE = \frac{1}{5} \cdot 59 \newline&#xA;MSE = 11.8&#xA;$$&#xA;MSE的值越小（即越接近0）说明模型预测误差很小，预测很准，如果MSE越大说明模型预测误差很大，预测不准确。&lt;/p&gt;</description>
    </item>
  </channel>
</rss>
